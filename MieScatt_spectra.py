#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Jan  8 09:40:45 2025

@author: winniep01
"""

import numpy as np
import matplotlib.pyplot as plt
import scipy.constants as c
from PyMieScatt import MieQ

plt.rcParams.update({'font.size': 14})

e_nk_gold_olmon = [[4.12500000e+00, 3.99193548e+00, 3.86718750e+00, 3.75000000e+00,
    3.63970588e+00, 3.53571429e+00, 3.43750000e+00, 3.34459459e+00,
    3.25657895e+00, 3.17307692e+00, 3.09375000e+00, 3.01829268e+00,
    2.94642857e+00, 2.87790698e+00, 2.81250000e+00, 2.75000000e+00,
    2.69021739e+00, 2.63297872e+00, 2.57812500e+00, 2.52551020e+00,
    2.47500000e+00, 2.42647059e+00, 2.37980769e+00, 2.33490566e+00,
    2.29166667e+00, 2.25000000e+00, 2.20982143e+00, 2.17105263e+00,
    2.13362069e+00, 2.09745763e+00, 2.06250000e+00, 2.02868852e+00,
    1.99596774e+00, 1.96428571e+00, 1.93359375e+00, 1.90384615e+00,
    1.87500000e+00, 1.84701493e+00, 1.81985294e+00, 1.79347826e+00,
    1.76785714e+00, 1.74295775e+00, 1.71875000e+00, 1.69520548e+00,
    1.67229730e+00, 1.65000000e+00, 1.62828947e+00, 1.60714286e+00,
    1.58653846e+00, 1.56645570e+00, 1.54687500e+00, 1.52777778e+00,
    1.50914634e+00, 1.49096386e+00, 1.47321429e+00, 1.45588235e+00,
    1.43895349e+00, 1.42241379e+00, 1.40625000e+00, 1.39044944e+00,
    1.37500000e+00, 1.35989011e+00, 1.34510870e+00, 1.33064516e+00,
    1.31648936e+00, 1.30263158e+00, 1.28906250e+00, 1.27577320e+00,
    1.26275510e+00, 1.25000000e+00, 1.23750000e+00, 1.22524752e+00,
    1.21323529e+00, 1.20145631e+00, 1.18990385e+00, 1.17857143e+00,
    1.16745283e+00, 1.15654206e+00, 1.14583333e+00, 1.13532110e+00,
    1.12500000e+00, 1.11486486e+00, 1.10491071e+00, 1.09513274e+00,
    1.08552632e+00, 1.07608696e+00, 1.06681034e+00, 1.05769231e+00,
    1.04872881e+00, 1.03991597e+00, 1.03125000e+00, 1.02272727e+00,
    1.01434426e+00, 1.00609756e+00, 9.97983871e-01, 9.90000000e-01,
    9.82142857e-01, 9.74409449e-01, 9.66796875e-01, 9.59302326e-01,
    9.51923077e-01, 9.44656489e-01, 9.37500000e-01, 9.30451128e-01,
    9.23507463e-01, 9.16666667e-01, 8.65384615e-01, 8.59375000e-01,
    8.53448276e-01, 8.47602740e-01, 8.41836735e-01, 8.36148649e-01,
    8.30536913e-01, 8.25000000e-01, 8.19536424e-01, 8.14144737e-01,
    8.08823529e-01, 8.03571429e-01, 7.98387097e-01, 7.93269231e-01,
    7.88216561e-01, 7.83227848e-01, 7.78301887e-01, 7.73437500e-01,
    7.68633540e-01, 7.63888889e-01, 7.59202454e-01, 7.54573171e-01,
    7.50000000e-01, 7.45481928e-01, 7.41017964e-01, 7.36607143e-01,
    7.32248521e-01, 7.27941176e-01, 7.23684211e-01, 7.19476744e-01,
    7.15317919e-01, 7.11206897e-01, 7.07142857e-01, 7.03125000e-01,
    6.99152542e-01, 6.95224719e-01, 6.91340782e-01, 6.87500000e-01,
    6.83701657e-01, 6.79945055e-01, 6.76229508e-01, 6.72554348e-01,
    6.68918919e-01, 6.65322581e-01, 6.61764706e-01, 6.58244681e-01,
    6.54761905e-01, 6.51315789e-01, 6.47905759e-01, 6.44531250e-01,
    6.41191710e-01, 6.37886598e-01, 6.34615385e-01, 6.31377551e-01,
    6.28172589e-01, 6.25000000e-01, 6.21859296e-01, 6.18750000e-01,
    6.16591928e-01, 6.12927192e-01, 6.11111111e-01, 6.07212954e-01,
    6.05134474e-01, 6.01311953e-01, 5.99563953e-01, 5.95811266e-01,
    5.93809981e-01, 5.89847474e-01, 5.88165399e-01, 5.84277620e-01,
    5.82352941e-01, 5.78541374e-01, 5.76654240e-01, 5.74779378e-01,
    5.70802583e-01, 5.68965517e-01, 5.65068493e-01, 5.63268093e-01,
    5.61224490e-01, 5.57432432e-01, 5.55680287e-01, 5.53691275e-01,
    5.51716451e-01, 5.48051373e-01, 5.46116505e-01, 5.44195251e-01,
    5.42287467e-01, 5.38511749e-01, 5.36410923e-01, 5.34557235e-01,
    5.32716315e-01, 5.28846154e-01, 5.27044293e-01, 5.25031820e-01,
    5.23255814e-01, 5.21272115e-01, 5.19303399e-01, 5.17349498e-01,
    5.13698630e-01, 5.11786600e-01, 5.09888752e-01, 5.07796471e-01,
    5.05928046e-01, 5.04073320e-01, 5.02232143e-01, 5.00202102e-01,
    4.98389046e-01, 4.96389892e-01, 4.94604317e-01, 4.92635350e-01,
    4.90681998e-01, 4.88744076e-01, 4.86821400e-01, 4.84913793e-01,
    4.83021077e-01, 4.81143079e-01, 4.79279628e-01, 4.77246433e-01,
    4.75412985e-01, 4.73593571e-01, 4.71608232e-01, 4.69639469e-01,
    4.67863894e-01, 4.65926205e-01, 4.64004499e-01, 4.62098581e-01,
    4.60208256e-01, 4.58163643e-01, 4.56305310e-01, 4.54461990e-01,
    4.52468007e-01, 4.50655499e-01, 4.48694706e-01, 4.46750903e-01,
    4.44823868e-01, 4.42913386e-01, 4.41019244e-01, 4.39141235e-01,
    4.37279152e-01, 4.35279634e-01, 4.33450088e-01, 4.31485356e-01,
    4.29538355e-01, 4.27756654e-01, 4.25843083e-01, 4.23946557e-01,
    4.21922946e-01, 4.20061100e-01, 4.18215613e-01, 4.16246216e-01,
    4.14295280e-01, 4.12362546e-01, 4.10447761e-01, 4.08550677e-01,
    4.06671048e-01, 4.04808636e-01, 4.02832031e-01, 4.01004537e-01,
    3.99064818e-01, 3.97143774e-01, 3.95241137e-01, 3.93356643e-01,
    3.91366224e-01, 3.89518414e-01, 3.87566552e-01, 3.85634154e-01,
    3.83839950e-01, 3.81826597e-01, 3.79950875e-01, 3.78093492e-01,
    3.76139818e-01, 3.74206229e-01, 3.72292419e-01, 3.70398084e-01,
    3.68522930e-01, 3.66558057e-01, 3.64721485e-01, 3.62796834e-01,
    3.60892388e-01, 3.59007833e-01, 3.57039815e-01, 3.55093257e-01,
    3.53268627e-01, 3.51362862e-01, 3.49378882e-01, 3.47514743e-01,
    3.45573862e-01, 3.43654540e-01, 3.41756421e-01, 3.39879154e-01,
    3.37930093e-01, 3.36003258e-01, 3.34098272e-01, 3.32214765e-01,
    3.30352376e-01, 3.28423567e-01, 3.26517150e-01, 3.24632739e-01,
    3.22685789e-01, 3.20762053e-01, 3.18861118e-01, 3.16982582e-01,
    3.15045825e-01, 3.13132591e-01, 3.11242455e-01, 3.09297676e-01,
    3.07377049e-01, 3.05480128e-01, 3.03606477e-01, 3.01682106e-01,
    2.99781977e-01, 2.97833935e-01, 2.95981823e-01, 2.94012830e-01,
    2.92138810e-01, 2.90220450e-01, 2.88327120e-01, 2.86392039e-01,
    2.84482759e-01, 2.82598767e-01, 2.80675890e-01, 2.78779004e-01,
    2.76845638e-01, 2.74938902e-01, 2.73058252e-01, 2.71143734e-01,
    2.69197303e-01, 2.67336358e-01, 2.65387090e-01, 2.63466042e-01,
    2.61572606e-01, 2.59651700e-01, 2.57758800e-01, 2.55840397e-01,
    2.53950339e-01, 2.52036660e-01, 2.50151607e-01, 2.48194946e-01,
    2.46317675e-01, 2.44420304e-01, 2.42504409e-01, 2.40571540e-01,
    2.38669238e-01, 2.36751483e-01, 2.34864301e-01, 2.32963102e-01,
    2.31049291e-01, 2.29124236e-01, 2.27230995e-01, 2.25286729e-01,
    2.23415779e-01, 2.21496331e-01, 2.19570617e-01, 2.17678100e-01,
    2.15742678e-01, 2.13841369e-01, 2.11936976e-01, 2.10030550e-01,
    2.08123108e-01, 2.06215631e-01, 2.04309064e-01, 2.02404318e-01,
    2.00469788e-01, 1.98571887e-01, 1.96678322e-01, 1.94759207e-01,
    1.92847125e-01, 1.90942756e-01, 1.89017871e-01, 1.87131408e-01,
    1.85199042e-01, 1.83306177e-01, 1.81398417e-01, 1.79477883e-01,
    1.77572105e-01, 1.75656494e-01, 1.73757372e-01, 1.71851132e-01,
    1.69939577e-01, 1.68024440e-01, 1.66107383e-01, 1.64211783e-01,
    1.62295082e-01, 1.60381026e-01, 1.58470995e-01, 1.56566296e-01,
    1.54668166e-01, 1.52758919e-01, 1.50841053e-01, 1.48934890e-01,
    1.47023880e-01, 1.45110225e-01, 1.43196019e-01, 1.41299383e-01,
    1.39389502e-01, 1.37469451e-01, 1.35571867e-01, 1.33653742e-01,
    1.31747046e-01, 1.29839471e-01, 1.27933423e-01, 1.26018330e-01,
    1.24109919e-01, 1.22161895e-01, 1.20262391e-01, 1.18421053e-01,
    1.16415804e-01, 1.14583333e-01, 1.12602366e-01, 1.10787825e-01,
    1.08839050e-01, 1.06957649e-01, 1.05050934e-01, 1.03125000e-01,
    1.01185609e-01, 9.93178170e-02, 9.73642801e-02, 9.54861111e-02,
    9.35374150e-02, 9.16666667e-02, 8.97389413e-02, 8.78282470e-02,
    8.59375000e-02, 8.40122200e-02, 8.21167883e-02, 8.02009073e-02,
    7.82732448e-02, 7.63888889e-02, 7.44584838e-02, 7.25381008e-02,
    7.06335616e-02, 6.87500000e-02, 6.68196544e-02, 6.49265477e-02,
    6.30091650e-02, 6.11111111e-02, 5.91822095e-02, 5.72916667e-02,
    5.53691275e-02, 5.34557235e-02, 5.15625000e-02, 4.96389892e-02],
   [1.59600000e+00, 1.64900000e+00, 1.68500000e+00, 1.70100000e+00,
    1.69500000e+00, 1.67100000e+00, 1.63700000e+00, 1.60600000e+00,
    1.58800000e+00, 1.58500000e+00, 1.58800000e+00, 1.58500000e+00,
    1.56700000e+00, 1.53700000e+00, 1.50500000e+00, 1.47200000e+00,
    1.42200000e+00, 1.33300000e+00, 1.19300000e+00, 1.01100000e+00,
    8.19700000e-01, 6.52700000e-01, 5.26300000e-01, 4.36300000e-01,
    3.72400000e-01, 3.25600000e-01, 2.89900000e-01, 2.61700000e-01,
    2.38800000e-01, 2.19900000e-01, 2.04100000e-01, 1.90800000e-01,
    1.79400000e-01, 1.69800000e-01, 1.61600000e-01, 1.54600000e-01,
    1.48700000e-01, 1.43600000e-01, 1.39400000e-01, 1.35800000e-01,
    1.32800000e-01, 1.30400000e-01, 1.28400000e-01, 1.26800000e-01,
    1.25700000e-01, 1.24800000e-01, 1.24200000e-01, 1.23900000e-01,
    1.23900000e-01, 1.24000000e-01, 1.24400000e-01, 1.24900000e-01,
    1.25600000e-01, 1.26500000e-01, 1.27500000e-01, 1.28600000e-01,
    1.29800000e-01, 1.31200000e-01, 1.32600000e-01, 1.34200000e-01,
    1.35800000e-01, 1.37500000e-01, 1.39300000e-01, 1.41200000e-01,
    1.43100000e-01, 1.45100000e-01, 1.47100000e-01, 1.49300000e-01,
    1.51400000e-01, 1.53600000e-01, 1.55900000e-01, 1.58200000e-01,
    1.60600000e-01, 1.63000000e-01, 1.65500000e-01, 1.68000000e-01,
    1.70500000e-01, 1.73100000e-01, 1.75700000e-01, 1.78300000e-01,
    1.81000000e-01, 1.83700000e-01, 1.86500000e-01, 1.89300000e-01,
    1.92100000e-01, 1.94900000e-01, 1.97800000e-01, 2.00700000e-01,
    2.03600000e-01, 2.06600000e-01, 2.09600000e-01, 2.12600000e-01,
    2.15700000e-01, 2.18700000e-01, 2.21800000e-01, 2.25000000e-01,
    2.28100000e-01, 2.31300000e-01, 2.34200000e-01, 2.37100000e-01,
    2.40000000e-01, 2.43000000e-01, 2.46000000e-01, 2.49000000e-01,
    2.52000000e-01, 2.55100000e-01, 2.82400000e-01, 2.85700000e-01,
    2.88900000e-01, 2.92200000e-01, 2.95500000e-01, 2.98800000e-01,
    3.02100000e-01, 3.05500000e-01, 3.08900000e-01, 3.12300000e-01,
    3.15700000e-01, 3.19100000e-01, 3.22600000e-01, 3.26000000e-01,
    3.29500000e-01, 3.33100000e-01, 3.36600000e-01, 3.40200000e-01,
    3.43700000e-01, 3.47400000e-01, 3.51000000e-01, 3.54600000e-01,
    3.58300000e-01, 3.62000000e-01, 3.65700000e-01, 3.69500000e-01,
    3.73200000e-01, 3.77000000e-01, 3.80800000e-01, 3.84700000e-01,
    3.88500000e-01, 3.92400000e-01, 3.96300000e-01, 4.00300000e-01,
    4.04200000e-01, 4.08200000e-01, 4.12300000e-01, 4.16300000e-01,
    4.20400000e-01, 4.24500000e-01, 4.28600000e-01, 4.32800000e-01,
    4.36900000e-01, 4.41200000e-01, 4.45400000e-01, 4.49700000e-01,
    4.54000000e-01, 4.58300000e-01, 4.62700000e-01, 4.67100000e-01,
    4.71500000e-01, 4.76000000e-01, 4.80500000e-01, 4.85100000e-01,
    4.89600000e-01, 4.94200000e-01, 4.98900000e-01, 5.03100000e-01,
    5.06800000e-01, 5.12900000e-01, 5.16000000e-01, 5.22400000e-01,
    5.25600000e-01, 5.32100000e-01, 5.35400000e-01, 5.42100000e-01,
    5.45500000e-01, 5.52400000e-01, 5.55900000e-01, 5.63000000e-01,
    5.66600000e-01, 5.73900000e-01, 5.77600000e-01, 5.81400000e-01,
    5.89000000e-01, 5.92900000e-01, 6.00700000e-01, 6.04700000e-01,
    6.08700000e-01, 6.16800000e-01, 6.21000000e-01, 6.25200000e-01,
    6.29400000e-01, 6.38000000e-01, 6.42300000e-01, 6.46800000e-01,
    6.51200000e-01, 6.60300000e-01, 6.64900000e-01, 6.69500000e-01,
    6.74200000e-01, 6.83700000e-01, 6.88600000e-01, 6.93500000e-01,
    6.98400000e-01, 7.03400000e-01, 7.08500000e-01, 7.13600000e-01,
    7.24000000e-01, 7.29300000e-01, 7.34700000e-01, 7.40100000e-01,
    7.45500000e-01, 7.51100000e-01, 7.56600000e-01, 7.62300000e-01,
    7.68000000e-01, 7.73800000e-01, 7.79700000e-01, 7.85600000e-01,
    7.91600000e-01, 7.97600000e-01, 8.03700000e-01, 8.09900000e-01,
    8.16200000e-01, 8.22600000e-01, 8.29000000e-01, 8.35500000e-01,
    8.42100000e-01, 8.48700000e-01, 8.55400000e-01, 8.62300000e-01,
    8.69200000e-01, 8.76100000e-01, 8.83200000e-01, 8.90400000e-01,
    8.97600000e-01, 9.04900000e-01, 9.12300000e-01, 9.19900000e-01,
    9.27500000e-01, 9.35200000e-01, 9.43000000e-01, 9.50900000e-01,
    9.58900000e-01, 9.67000000e-01, 9.75200000e-01, 9.83500000e-01,
    9.91900000e-01, 1.00000000e+00, 1.00900000e+00, 1.01800000e+00,
    1.02700000e+00, 1.03600000e+00, 1.04500000e+00, 1.05400000e+00,
    1.06300000e+00, 1.07300000e+00, 1.08200000e+00, 1.09200000e+00,
    1.10200000e+00, 1.11200000e+00, 1.12200000e+00, 1.13200000e+00,
    1.14300000e+00, 1.15300000e+00, 1.16400000e+00, 1.17500000e+00,
    1.18600000e+00, 1.19700000e+00, 1.20900000e+00, 1.22000000e+00,
    1.23200000e+00, 1.24400000e+00, 1.25600000e+00, 1.26800000e+00,
    1.28000000e+00, 1.29300000e+00, 1.30500000e+00, 1.31800000e+00,
    1.33100000e+00, 1.34500000e+00, 1.35800000e+00, 1.37200000e+00,
    1.38600000e+00, 1.40000000e+00, 1.41400000e+00, 1.42900000e+00,
    1.44400000e+00, 1.45900000e+00, 1.47400000e+00, 1.49000000e+00,
    1.50500000e+00, 1.52100000e+00, 1.53800000e+00, 1.55400000e+00,
    1.57100000e+00, 1.58800000e+00, 1.60500000e+00, 1.62300000e+00,
    1.64100000e+00, 1.65900000e+00, 1.67800000e+00, 1.69700000e+00,
    1.71600000e+00, 1.73500000e+00, 1.75500000e+00, 1.77500000e+00,
    1.79600000e+00, 1.81700000e+00, 1.83800000e+00, 1.85900000e+00,
    1.88100000e+00, 1.90400000e+00, 1.92700000e+00, 1.95000000e+00,
    1.97400000e+00, 1.99800000e+00, 2.02200000e+00, 2.04700000e+00,
    2.07200000e+00, 2.09800000e+00, 2.12500000e+00, 2.15200000e+00,
    2.17900000e+00, 2.20700000e+00, 2.23500000e+00, 2.26400000e+00,
    2.29400000e+00, 2.32400000e+00, 2.35500000e+00, 2.38600000e+00,
    2.41800000e+00, 2.45100000e+00, 2.48400000e+00, 2.51800000e+00,
    2.55300000e+00, 2.58800000e+00, 2.62400000e+00, 2.66100000e+00,
    2.69900000e+00, 2.73700000e+00, 2.77600000e+00, 2.81700000e+00,
    2.85800000e+00, 2.89900000e+00, 2.94200000e+00, 2.98600000e+00,
    3.03100000e+00, 3.07700000e+00, 3.12300000e+00, 3.17100000e+00,
    3.22000000e+00, 3.27000000e+00, 3.32100000e+00, 3.37400000e+00,
    3.42700000e+00, 3.48200000e+00, 3.53900000e+00, 3.59600000e+00,
    3.65500000e+00, 3.71600000e+00, 3.77800000e+00, 3.84100000e+00,
    3.90600000e+00, 3.97300000e+00, 4.04200000e+00, 4.11200000e+00,
    4.18400000e+00, 4.25800000e+00, 4.33400000e+00, 4.41200000e+00,
    4.49200000e+00, 4.57400000e+00, 4.65800000e+00, 4.74500000e+00,
    4.83400000e+00, 4.92600000e+00, 5.02000000e+00, 5.11700000e+00,
    5.21600000e+00, 5.31900000e+00, 5.42400000e+00, 5.53300000e+00,
    5.64500000e+00, 5.76000000e+00, 5.87900000e+00, 6.00100000e+00,
    6.12700000e+00, 6.25800000e+00, 6.39200000e+00, 6.53000000e+00,
    6.67300000e+00, 6.82000000e+00, 6.97300000e+00, 7.13000000e+00,
    7.29300000e+00, 7.46100000e+00, 7.63400000e+00, 7.81400000e+00,
    8.00000000e+00, 8.19300000e+00, 8.39200000e+00, 8.59800000e+00,
    8.81200000e+00, 9.03400000e+00, 9.26300000e+00, 9.50200000e+00,
    9.74900000e+00, 1.00100000e+01, 1.02700000e+01, 1.05500000e+01,
    1.08400000e+01, 1.11400000e+01, 1.14500000e+01, 1.17700000e+01,
    1.21100000e+01, 1.24600000e+01, 1.28300000e+01, 1.32100000e+01,
    1.36100000e+01, 1.40200000e+01, 1.44600000e+01, 1.49100000e+01,
    1.53800000e+01, 1.58800000e+01, 1.64000000e+01, 1.69400000e+01,
    1.75100000e+01, 1.81000000e+01, 1.87200000e+01, 1.93800000e+01,
    2.00600000e+01, 2.07800000e+01, 2.15400000e+01, 2.23300000e+01,
    2.31700000e+01, 2.40400000e+01, 2.49700000e+01, 2.59400000e+01,
    2.69700000e+01, 2.80500000e+01, 2.91900000e+01, 3.03900000e+01,
    3.16600000e+01, 3.30000000e+01, 3.44100000e+01, 3.59100000e+01,
    3.74900000e+01, 3.91600000e+01, 4.09200000e+01, 4.27900000e+01],
   [1.88800000e+00, 1.89500000e+00, 1.88100000e+00, 1.85800000e+00,
    1.83500000e+00, 1.82100000e+00, 1.82500000e+00, 1.84600000e+00,
    1.87700000e+00, 1.90400000e+00, 1.91500000e+00, 1.91100000e+00,
    1.89800000e+00, 1.88700000e+00, 1.87700000e+00, 1.85500000e+00,
    1.81200000e+00, 1.75800000e+00, 1.71600000e+00, 1.72000000e+00,
    1.78700000e+00, 1.90800000e+00, 2.05800000e+00, 2.21300000e+00,
    2.36400000e+00, 2.50700000e+00, 2.64100000e+00, 2.76900000e+00,
    2.89100000e+00, 3.00900000e+00, 3.12200000e+00, 3.23200000e+00,
    3.34000000e+00, 3.44400000e+00, 3.54700000e+00, 3.64700000e+00,
    3.74600000e+00, 3.84300000e+00, 3.93800000e+00, 4.03300000e+00,
    4.12600000e+00, 4.21700000e+00, 4.30800000e+00, 4.39800000e+00,
    4.48700000e+00, 4.57500000e+00, 4.66200000e+00, 4.74900000e+00,
    4.83400000e+00, 4.92000000e+00, 5.00400000e+00, 5.08800000e+00,
    5.17200000e+00, 5.25500000e+00, 5.33800000e+00, 5.42000000e+00,
    5.50100000e+00, 5.58300000e+00, 5.66400000e+00, 5.74500000e+00,
    5.82500000e+00, 5.90500000e+00, 5.98500000e+00, 6.06400000e+00,
    6.14300000e+00, 6.22200000e+00, 6.30100000e+00, 6.37900000e+00,
    6.45700000e+00, 6.53500000e+00, 6.61300000e+00, 6.69000000e+00,
    6.76800000e+00, 6.84500000e+00, 6.92200000e+00, 6.99900000e+00,
    7.07500000e+00, 7.15200000e+00, 7.22800000e+00, 7.30400000e+00,
    7.38000000e+00, 7.45600000e+00, 7.53200000e+00, 7.60800000e+00,
    7.68300000e+00, 7.75900000e+00, 7.83400000e+00, 7.90900000e+00,
    7.98400000e+00, 8.05900000e+00, 8.13400000e+00, 8.20800000e+00,
    8.28300000e+00, 8.35800000e+00, 8.43200000e+00, 8.50600000e+00,
    8.58100000e+00, 8.65500000e+00, 8.72500000e+00, 8.79500000e+00,
    8.86500000e+00, 8.93500000e+00, 9.00500000e+00, 9.07500000e+00,
    9.14500000e+00, 9.21400000e+00, 9.79600000e+00, 9.86500000e+00,
    9.93400000e+00, 1.00000000e+01, 1.00700000e+01, 1.01400000e+01,
    1.02100000e+01, 1.02800000e+01, 1.03500000e+01, 1.04100000e+01,
    1.04800000e+01, 1.05500000e+01, 1.06200000e+01, 1.06900000e+01,
    1.07600000e+01, 1.08200000e+01, 1.08900000e+01, 1.09600000e+01,
    1.10300000e+01, 1.11000000e+01, 1.11600000e+01, 1.12300000e+01,
    1.13000000e+01, 1.13700000e+01, 1.14400000e+01, 1.15000000e+01,
    1.15700000e+01, 1.16400000e+01, 1.17100000e+01, 1.17700000e+01,
    1.18400000e+01, 1.19100000e+01, 1.19800000e+01, 1.20400000e+01,
    1.21100000e+01, 1.21800000e+01, 1.22500000e+01, 1.23100000e+01,
    1.23800000e+01, 1.24500000e+01, 1.25200000e+01, 1.25800000e+01,
    1.26500000e+01, 1.27200000e+01, 1.27800000e+01, 1.28500000e+01,
    1.29200000e+01, 1.29900000e+01, 1.30500000e+01, 1.31200000e+01,
    1.31900000e+01, 1.32500000e+01, 1.33200000e+01, 1.33900000e+01,
    1.34600000e+01, 1.35200000e+01, 1.35900000e+01, 1.36500000e+01,
    1.37000000e+01, 1.37900000e+01, 1.38400000e+01, 1.39300000e+01,
    1.39700000e+01, 1.40600000e+01, 1.41100000e+01, 1.42000000e+01,
    1.42500000e+01, 1.43500000e+01, 1.43900000e+01, 1.44900000e+01,
    1.45400000e+01, 1.46400000e+01, 1.46900000e+01, 1.47400000e+01,
    1.48400000e+01, 1.48900000e+01, 1.50000000e+01, 1.50500000e+01,
    1.51000000e+01, 1.52100000e+01, 1.52600000e+01, 1.53200000e+01,
    1.53700000e+01, 1.54800000e+01, 1.55400000e+01, 1.55900000e+01,
    1.56500000e+01, 1.57600000e+01, 1.58200000e+01, 1.58800000e+01,
    1.59400000e+01, 1.60600000e+01, 1.61100000e+01, 1.61700000e+01,
    1.62400000e+01, 1.63000000e+01, 1.63600000e+01, 1.64200000e+01,
    1.65400000e+01, 1.66100000e+01, 1.66700000e+01, 1.67300000e+01,
    1.68000000e+01, 1.68600000e+01, 1.69300000e+01, 1.70000000e+01,
    1.70600000e+01, 1.71300000e+01, 1.72000000e+01, 1.72600000e+01,
    1.73300000e+01, 1.74000000e+01, 1.74700000e+01, 1.75400000e+01,
    1.76100000e+01, 1.76800000e+01, 1.77500000e+01, 1.78300000e+01,
    1.79000000e+01, 1.79700000e+01, 1.80500000e+01, 1.81200000e+01,
    1.82000000e+01, 1.82700000e+01, 1.83500000e+01, 1.84300000e+01,
    1.85000000e+01, 1.85800000e+01, 1.86600000e+01, 1.87400000e+01,
    1.88200000e+01, 1.89000000e+01, 1.89800000e+01, 1.90600000e+01,
    1.91500000e+01, 1.92300000e+01, 1.93200000e+01, 1.94000000e+01,
    1.94900000e+01, 1.95700000e+01, 1.96600000e+01, 1.97500000e+01,
    1.98400000e+01, 1.99300000e+01, 2.00200000e+01, 2.01100000e+01,
    2.02000000e+01, 2.02900000e+01, 2.03800000e+01, 2.04800000e+01,
    2.05700000e+01, 2.06700000e+01, 2.07700000e+01, 2.08600000e+01,
    2.09600000e+01, 2.10600000e+01, 2.11600000e+01, 2.12600000e+01,
    2.13700000e+01, 2.14700000e+01, 2.15700000e+01, 2.16800000e+01,
    2.17900000e+01, 2.18900000e+01, 2.20000000e+01, 2.21100000e+01,
    2.22200000e+01, 2.23300000e+01, 2.24500000e+01, 2.25600000e+01,
    2.26700000e+01, 2.27900000e+01, 2.29100000e+01, 2.30200000e+01,
    2.31400000e+01, 2.32600000e+01, 2.33900000e+01, 2.35100000e+01,
    2.36300000e+01, 2.37600000e+01, 2.38900000e+01, 2.40100000e+01,
    2.41400000e+01, 2.42800000e+01, 2.44100000e+01, 2.45400000e+01,
    2.46800000e+01, 2.48100000e+01, 2.49500000e+01, 2.50900000e+01,
    2.52300000e+01, 2.53800000e+01, 2.55200000e+01, 2.56700000e+01,
    2.58100000e+01, 2.59600000e+01, 2.61100000e+01, 2.62700000e+01,
    2.64200000e+01, 2.65800000e+01, 2.67300000e+01, 2.68900000e+01,
    2.70600000e+01, 2.72200000e+01, 2.73800000e+01, 2.75500000e+01,
    2.77200000e+01, 2.78900000e+01, 2.80700000e+01, 2.82400000e+01,
    2.84200000e+01, 2.86000000e+01, 2.87800000e+01, 2.89700000e+01,
    2.91500000e+01, 2.93400000e+01, 2.95400000e+01, 2.97300000e+01,
    2.99300000e+01, 3.01300000e+01, 3.03300000e+01, 3.05300000e+01,
    3.07400000e+01, 3.09500000e+01, 3.11600000e+01, 3.13800000e+01,
    3.16000000e+01, 3.18200000e+01, 3.20400000e+01, 3.22700000e+01,
    3.25000000e+01, 3.27400000e+01, 3.29700000e+01, 3.32100000e+01,
    3.34600000e+01, 3.37100000e+01, 3.39600000e+01, 3.42100000e+01,
    3.44700000e+01, 3.47300000e+01, 3.50000000e+01, 3.52700000e+01,
    3.55500000e+01, 3.58200000e+01, 3.61100000e+01, 3.64000000e+01,
    3.66900000e+01, 3.69800000e+01, 3.72900000e+01, 3.75900000e+01,
    3.79000000e+01, 3.82200000e+01, 3.85400000e+01, 3.88700000e+01,
    3.92000000e+01, 3.95400000e+01, 3.98800000e+01, 4.02300000e+01,
    4.05900000e+01, 4.09500000e+01, 4.13200000e+01, 4.16900000e+01,
    4.20700000e+01, 4.24600000e+01, 4.28500000e+01, 4.32600000e+01,
    4.36700000e+01, 4.40800000e+01, 4.45100000e+01, 4.49400000e+01,
    4.53800000e+01, 4.58300000e+01, 4.62900000e+01, 4.67600000e+01,
    4.72300000e+01, 4.77200000e+01, 4.82100000e+01, 4.87200000e+01,
    4.92400000e+01, 4.97600000e+01, 5.03000000e+01, 5.08500000e+01,
    5.14100000e+01, 5.19800000e+01, 5.25700000e+01, 5.31700000e+01,
    5.37800000e+01, 5.44000000e+01, 5.50400000e+01, 5.57000000e+01,
    5.63700000e+01, 5.70500000e+01, 5.77500000e+01, 5.84700000e+01,
    5.92000000e+01, 5.99600000e+01, 6.07300000e+01, 6.15200000e+01,
    6.23300000e+01, 6.31600000e+01, 6.40100000e+01, 6.48900000e+01,
    6.57800000e+01, 6.67100000e+01, 6.76500000e+01, 6.86300000e+01,
    6.96300000e+01, 7.06500000e+01, 7.17100000e+01, 7.28000000e+01,
    7.39100000e+01, 7.50700000e+01, 7.62500000e+01, 7.74700000e+01,
    7.87300000e+01, 8.00300000e+01, 8.13700000e+01, 8.27600000e+01,
    8.41800000e+01, 8.56600000e+01, 8.71800000e+01, 8.87600000e+01,
    9.03900000e+01, 9.20800000e+01, 9.38300000e+01, 9.56400000e+01,
    9.75200000e+01, 9.94700000e+01, 1.01500000e+02, 1.03600000e+02,
    1.05800000e+02, 1.08100000e+02, 1.10400000e+02, 1.12900000e+02,
    1.15500000e+02, 1.18200000e+02, 1.21000000e+02, 1.24000000e+02,
    1.27100000e+02, 1.30400000e+02, 1.33900000e+02, 1.37500000e+02]]
e_nk_gold_olmon = [np.flip(e_nk_gold_olmon[0]), np.flip(e_nk_gold_olmon[1]), np.flip(e_nk_gold_olmon[2])]



def refractive_index_gold(E):
    """Interpolate the refractive index of gold at a given energy (eV)."""
    E_data = e_nk_gold_olmon[0]
    n_data = e_nk_gold_olmon[1] + 1j * e_nk_gold_olmon[2]
    n_gold = np.interp(E, E_data, n_data.real) + 1j * np.interp(E, E_data, n_data.imag)
    return n_gold


def spectrum(d, nmedium=1, nvalues=1000, E_range=[1, 3]):
    E = np.linspace(E_range[0], E_range[1], nvalues)
    wl = c.h*c.c/(E*c.e) * 1e9
    y = []
    x = np.linspace(E_range[0], E_range[1], nvalues)
    for n in range(nvalues):
        mshell = refractive_index_gold(E[n])
        y.append(MieQ(mshell, wl[n], d)[0])
        
    return x,y

num = 10

d_core = np.linspace(30, 300, num=num)

cmap = plt.get_cmap('viridis')
colors = cmap(np.linspace(0, 1, num))

plt.figure(figsize=(3,6))
plt.tick_params(axis='both', direction='in')

for i in range(len(d_core)):
    x,y = spectrum(d_core[i])
    plt.plot(x ,np.array(y) + i*1.1 , label=str(int(round(d_core[i],0)))+' nm', color=colors[i])


plt.xlabel("energy (eV)")
plt.yticks([])
plt.xlim([1.25,2.75])
plt.ylabel("extinction (arb. unit)")
plt.tight_layout()
plt.savefig("/home/winniep01/miescattspectra.pdf")
plt.show()
